<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TeraTV Player</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        /* Custom Scrollbar for Webkit */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #09090b; 
        }
        ::-webkit-scrollbar-thumb {
            background: #27272a; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #3f3f46; 
        }

        /* Loader Animation */
        .loader {
            width: 48px;
            height: 48px;
            border: 3px solid #FFF;
            border-bottom-color: transparent;
            border-radius: 50%;
            display: inline-block;
            box-sizing: border-box;
            animation: rotation 1s linear infinite;
        }

        @keyframes rotation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Hide controls initially to prevent flash */
        video::-webkit-media-controls {
            display: flex !important;
        }
        
        /* Smooth Fade In */
        .fade-in {
            animation: fadeIn 0.5s ease-in-out forwards;
            opacity: 0;
        }

        @keyframes fadeIn {
            to { opacity: 1; }
        }

        body {
            background-color: #000000;
            color: #ffffff;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            padding: 0;
        }

        /* Premium Glass Effect */
        .glass-panel {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
    </style>
</head>
<body class="selection:bg-white selection:text-black">

    <!-- Loading State -->
    <div id="loaderContainer" class="fixed inset-0 z-50 flex flex-col items-center justify-content-center bg-black flex justify-center items-center">
        <span class="loader mb-4"></span>
        <p class="text-zinc-500 text-sm tracking-widest uppercase">Loading Media</p>
    </div>

    <!-- Error State -->
    <div id="errorContainer" class="hidden fixed inset-0 z-40 flex flex-col items-center justify-center bg-black p-6 text-center fade-in">
        <div class="w-16 h-16 rounded-full bg-red-900/20 flex items-center justify-center mb-4 text-red-500">
            <i class="fa-solid fa-circle-exclamation text-2xl"></i>
        </div>
        <h2 class="text-xl font-medium text-white mb-2">Unable to Play</h2>
        <p id="errorMessage" class="text-zinc-500 max-w-md">The video source is missing or invalid.</p>
    </div>

    <!-- Main Player Interface -->
    <div id="playerApp" class="hidden w-full max-w-5xl px-4 md:px-6 flex-col items-center justify-center fade-in pb-10">
        
        <!-- Video Container -->
        <div class="relative w-full aspect-video bg-zinc-900 rounded-2xl overflow-hidden shadow-2xl ring-1 ring-white/5 group">
            
            <!-- The Video Player -->
            <!-- Playsinline for iOS, Controls for native functionality -->
            <video 
                id="mainVideo" 
                class="w-full h-full object-contain bg-black focus:outline-none" 
                controls 
                playsinline 
                preload="auto"
                controlsList="nodownload" 
            >
                Your browser does not support the video tag.
            </video>

        </div>

        <!-- Controls / Actions Area -->
        <div class="w-full mt-6 flex flex-col items-center gap-4">
            
            <!-- Download Button -->
            <a id="downloadBtn" href="#" target="_blank" class="group relative inline-flex items-center gap-3 px-8 py-3.5 bg-zinc-900 hover:bg-zinc-800 text-white rounded-full transition-all duration-300 ring-1 ring-white/10 hover:ring-white/20 hover:shadow-[0_0_20px_rgba(255,255,255,0.1)] active:scale-95 no-underline">
                <i class="fa-solid fa-download text-zinc-400 group-hover:text-white transition-colors"></i>
                <span class="font-medium text-sm tracking-wide text-zinc-300 group-hover:text-white transition-colors">Download Video</span>
            </a>
            
            <p class="text-xs text-zinc-700 mt-2">TeraTV Player</p>
        </div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // DOM Elements
            const loader = document.getElementById('loaderContainer');
            const errorContainer = document.getElementById('errorContainer');
            const errorMessage = document.getElementById('errorMessage');
            const playerApp = document.getElementById('playerApp');
            const video = document.getElementById('mainVideo');
            const downloadBtn = document.getElementById('downloadBtn');

            // 1. Get URL Parameter
            const urlParams = new URLSearchParams(window.location.search);
            const videoSrc = urlParams.get('vid');

            // Helper: Show Error
            function showError(msg) {
                loader.style.display = 'none';
                playerApp.style.display = 'none';
                errorContainer.style.display = 'flex'; // Flex to center content
                if(msg) errorMessage.textContent = msg;
            }

            // Helper: Initialize Player
            function initPlayer(src) {
                // Set video source
                video.src = src;

                // Setup Download Button
                // We use target="_blank" because direct download attributes 
                // often fail with cross-origin resources.
                downloadBtn.href = src;
                
                // Event: Load Start (Already showing loader by default)
                
                // Event: Can Play / Loaded Data
                video.addEventListener('loadeddata', () => {
                    // Hide loader, show player
                    loader.style.display = 'none';
                    playerApp.style.display = 'flex';
                    
                    // Attempt Auto-play
                    const playPromise = video.play();
                    if (playPromise !== undefined) {
                        playPromise.catch(error => {
                            // Auto-play was prevented.
                            // This is normal on many browsers/mobiles until user interaction.
                            // We leave the controls visible so user can tap play.
                            console.log('Autoplay prevented by browser policy.');
                        });
                    }
                });

                // Event: Error
                video.addEventListener('error', (e) => {
                    console.error("Video Error:", video.error);
                    let msg = "An error occurred while trying to load the video.";
                    if (video.error) {
                        switch (video.error.code) {
                            case MediaError.MEDIA_ERR_ABORTED:
                                msg = "Video playback aborted.";
                                break;
                            case MediaError.MEDIA_ERR_NETWORK:
                                msg = "A network error caused the video download to fail.";
                                break;
                            case MediaError.MEDIA_ERR_DECODE:
                                msg = "The video playback was aborted due to a corruption problem.";
                                break;
                            case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:
                                msg = "The video format is not supported or source is unavailable.";
                                break;
                        }
                    }
                    showError(msg);
                });
            }

            // 2. Validation Logic
            if (!videoSrc) {
                // No 'vid' parameter found
                showError("No video source provided.");
            } else {
                // Basic URL validation (optional, keeps it robust)
                try {
                    const validUrl = new URL(videoSrc);
                    initPlayer(videoSrc);
                } catch (e) {
                    // Try to play it anyway if it's a relative path or raw string, 
                    // but usually it should be a full URL.
                    // For safety, we trust the param but handle the error event if it fails.
                    initPlayer(videoSrc);
                }
            }

            // 3. UI Interactions
            // Add subtle keyboard support for spacebar play/pause if focused on body
            document.addEventListener('keydown', (e) => {
                if (e.code === 'Space' && playerApp.style.display === 'flex') {
                    // Check if focus is not on the button
                    if (document.activeElement !== downloadBtn) {
                        e.preventDefault(); // prevent scroll
                        if (video.paused) video.play();
                        else video.pause();
                    }
                }
            });
        });
    </script>
</body>
</html>

